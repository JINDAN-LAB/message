<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jindan.jdy.mapper.JdyFlowMapper">

	<resultMap id="BaseResultp" type="com.jindan.jdy.common.pojo.JdyFlow">
		<id column="flow_id" property="flowId" />
		<id column="flow_persoms" property="flowPersom" />
		<id column="flow_remarks" property="flowRemarks" />
		<id column="flow_result" property="flowResult" />
		<id column="flow_time" property="flowTime" />
		<id column="insert_time" property="insertTime" />
		<id column="update_time" property="updateTime" />
		<id column="delete_id" property="deleteId" />
		<id column="parent_id" property="parentId" />
	 </resultMap>

	<resultMap id="BaseResultMap" type="com.jindan.jdy.common.dto.JdyFlowDto">
		<id column="flow_id" property="flowId" />
		<id column="flow_persoms" property="flowPersom" />
		<id column="flow_remarks" property="flowRemarks" />
		<id column="flow_result" property="flowResult" />
		<id column="flow_time" property="flowTime" />
		<id column="insert_time" property="insertTime" />
		<id column="update_time" property="updateTime" />
		<id column="delete_id" property="deleteId" />
		<id column="parent_id" property="parentId" />
		<association property="jdyUser"  column="user_id" javaType="com.jindan.jdy.common.pojo.JdyUser">
			<id column="user_id" property="userId" />
			<id column="username" property="username" />
			<id column="password" property="password" />
			<id column="wechar_id" property="wecharId" />
			<id column="role_id" property="roleId" />
			<id column="phone" property="phone" />
			<id column="email" property="email" />
			<id column="power" property="power" />
			<id column="status" property="status" />
			<id column="icon" property="icon" />
			<id column="delete_id" property="deleteId" />
			<id column="update_time" property="updateTime" />
			<id column="insert_time" property="insertTime" />
		</association>
	</resultMap>
	<sql id="Base_Column_List">
		flow_id, flow_persom, flow_remarks, flow_result, flow_time, insert_time, update_time, delete_id, parent_id
	</sql>

	<sql id="selectexpend">
		<where>
			<if test="flowId != null and flowId !='' ">
				and jdy_flow.flow_id = #{flowId}
			</if>
			<if test="flowPersom != null and flowPersom !='' ">
				and jdy_flow.flow_persom = #{flowPersom}
			</if>
			<if test="flowResult != null and flowResult !='' ">
				and jdy_flow.flow_result = #{flowResult}
			</if>
			<if test="flowType != null and flowType !='' ">
				and jdy_flow.flow_type = #{flowType}
			</if>
			<if test="parentId != null and parentId !='' ">
				and jdy_flow.parent_id = #{parentId}
			</if>
			and jdy_flow.delete_id='0'
		</where>
	</sql>

<!--	seleteJdyFlowperson-->
	<select id="seleteJdyFlowperson"  parameterType="com.jindan.jdy.common.dto.JdyFlowDto" resultMap="BaseResultMap">
		SELECT
		jdy_flow.flow_id,
		jdy_flow.flow_remarks,
		jdy_flow.flow_result,
		jdy_flow.flow_time,
		jdy_flow.parent_id,
        jdy_user.username as flow_persoms
		 FROM jdy_flow
		LEFT JOIN jdy_user  ON jdy_user.user_id =jdy_flow.flow_persom
		and jdy_user.delete_id = '0'
		 <include refid="selectexpend"></include>
	</select>


</mapper>